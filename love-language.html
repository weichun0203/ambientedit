<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 6.<title>規則為"常溫"+重點標題+"｜Ambient"+ 英文標題 -->
    <title>常溫愛的六種方式｜Ambient Love Languages Analysis</title>
    <meta name="description" content="透過常溫編集所的互動分析，探索屬於你的愛之語。了解肯定的言語、服務的行動、真心的禮物、精心的時刻、身體的接觸以及心靈的連結。">
    
    <!-- 4.放入<meta>與Json-ld -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="常溫愛的六種方式｜Ambient Love Languages Analysis">
    <meta property="og:description" content="探索你靈魂深處被愛的需求，常溫編集所心理測驗。">
    <meta property="og:url" content="https://weichun0203.github.io/ambientedit/love-languages">
    <meta property="og:image" content="https://weichun0203.github.io/ambientedit/og-image.jpg">

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "name": "常溫愛的六種方式｜Ambient Love Languages Analysis",
      "publisher": {
        "@type": "Organization",
        "name": "常溫編集所 Ambient Edit Studio",
        "url": "https://weichun0203.github.io/ambientedit/"
      },
      "description": "一個互動式網頁應用，用於分析使用者偏好的愛之語並提供詳細介紹。"
    }
    </script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Noto+Serif+TC:wght@300;400;600;700&display=swap" rel="stylesheet">

    <!-- 1.放在<head>之後的GA4追蹤碼 -->
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2F079YMSFW"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-2F079YMSFW');
    </script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            paper: '#fdfbf7',
                            ink: '#4a4a4a',
                            sage: '#8da399',
                            clay: '#d4a59a',
                            sand: '#e6e2dd',
                        }
                    },
                    fontFamily: {
                        serif: ['"Noto Serif TC"', 'serif'],
                        sans: ['"Noto Sans TC"', 'sans-serif'],
                    },
                    boxShadow: {
                        soft: '0 4px 20px -2px rgba(0, 0, 0, 0.05)',
                        card: '0 10px 30px -5px rgba(0, 0, 0, 0.1)',
                    },
                    animation: {
                        'float': 'float 3s ease-in-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-5px)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #fdfbf7;
            color: #4a4a4a;
            /* 模擬紙張纖維質感的微噪點 SVG */
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.03'/%3E%3C/svg%3E");
        }
        .fade-in {
            animation: fadeIn 0.8s ease-in-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .option-btn:hover {
            transform: translateY(-2px);
        }
        /* Chart Animation */
        .chart-bar {
            width: 0;
            transition: width 1.5s cubic-bezier(0.22, 1, 0.36, 1);
        }
        /* Hide scrollbar for clean look */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        /* Modal Backdrop */
        .modal-backdrop {
            background-color: rgba(253, 251, 247, 0.85);
            backdrop-filter: blur(4px);
        }
    </style>
</head>
<body class="font-sans min-h-screen flex flex-col selection:bg-brand-sage selection:text-white">

    <!-- Header Section -->
    <header class="w-full max-w-4xl mx-auto px-6 pt-12 pb-8">
        <div class="flex flex-col items-center relative text-center">
            <!-- 7.加入品牌名在副標題並放在標題上方 -->
            <h2 class="text-brand-sage text-sm tracking-[0.2em] mb-2 font-medium">常溫編集所 AMBIENT EDIT STUDIO</h2>
            
            <!-- 標題區域：Grid 佈局確保絕對置中與底部對齊 -->
            <div class="w-full grid grid-cols-1 md:grid-cols-3 items-end border-b border-brand-sand/50 pb-6 mb-6 gap-4 md:gap-0">
                
                <!-- 左側：佔位區 -->
                <div class="hidden md:block"></div>

                <!-- 中間：主標題 (絕對置中) -->
                <div class="text-center w-full">
                    <h1 class="font-serif text-3xl md:text-4xl text-brand-ink tracking-wide leading-snug">
                        愛的六種方式<br>
                        <span class="text-lg md:text-xl text-brand-sage/80 mt-2 block font-light italic">The 6 Love Languages</span>
                    </h1>
                </div>

                <!-- 右側：返回首頁按鈕 (復原文字與 ICON) -->
                <div class="flex justify-center md:justify-end w-full">
                     <a href="https://weichun0203.github.io/ambientedit/" 
                       class="group inline-flex items-center px-4 py-2 rounded-full border border-brand-sand hover:border-brand-sage hover:bg-white transition-all duration-300 shadow-sm hover:shadow-soft bg-white/50 backdrop-blur-sm"
                       aria-label="返回常溫首頁"
                       style="text-decoration: none;">
                       
                        <!-- Icon -->
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-brand-sage group-hover:text-brand-ink transition-colors duration-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                            <polyline points="9 22 9 12 15 12 15 22"/>
                        </svg>
                        
                        <!-- Text: 確保文字顯示 -->
                        <span class="ml-2 text-xs font-bold tracking-widest text-brand-sage group-hover:text-brand-ink transition-colors duration-300">
                            常溫首頁
                        </span>
                    </a>
                </div>
            </div>

            <!-- 7.引言請在標題下方 -->
            <p class="text-brand-ink/70 font-serif leading-relaxed max-w-2xl text-justify md:text-center mx-auto">
                每個人都有屬於自己感受愛的頻率。透過簡單的選擇，我們將協助你調頻，找到那份讓心靈最感平靜與被愛的方式。請跟隨直覺，選擇在當下最能觸動你的情境。
            </p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow w-full max-w-2xl mx-auto px-6 py-8 relative">
        
        <!-- Start Screen (Menu) -->
        <div id="start-screen" class="fade-in text-center py-6">
            <div class="inline-block p-8 md:p-12 border border-brand-sand rounded-lg bg-white/40 shadow-soft backdrop-blur-sm max-w-xl w-full">
                <h3 class="text-brand-sage text-sm tracking-widest mb-6 font-bold">歡迎來到心靈調頻室</h3>
                <p class="text-brand-ink mb-10 font-serif text-lg leading-loose text-justify md:text-center">
                    我們常以為自己給予了足夠的愛，<br class="hidden md:block">卻忽略了對方接收的頻率是否相同。<br>
                    你可以選擇深入了解這六種語言，<br>
                    或是直接開始探索屬於你的頻率。
                </p>
                
                <!-- 雙按鈕設計 -->
                <div class="flex flex-col md:flex-row gap-4 justify-center">
                    <button onclick="showIntro()" class="px-8 py-3 border border-brand-sage text-brand-sage rounded hover:bg-brand-sage hover:text-white transition-all duration-300 tracking-widest text-sm shadow-sm group">
                        <span class="group-hover:tracking-[0.1em] transition-all duration-300">認識愛之語</span>
                    </button>
                    <!-- 更改為 18題 -->
                    <button onclick="startQuiz()" class="px-8 py-3 bg-brand-sage text-white rounded hover:bg-brand-ink transition-colors duration-300 tracking-widest text-sm shadow-md group">
                        <span class="group-hover:tracking-[0.2em] transition-all duration-300">開始測驗 (18題)</span>
                    </button>
                </div>

                <div id="history-alert" class="hidden mt-8 text-sm text-brand-clay border-t border-brand-sand/50 pt-4">
                    * 偵測到您上次的測驗紀錄，<button onclick="showResult()" class="underline hover:text-brand-ink">點此直接查看結果</button>
                </div>
            </div>
        </div>

        <!-- Intro Screen (Interactive Cards) -->
        <div id="intro-screen" class="hidden fade-in">
            <div class="mb-8 text-center">
                <button onclick="backToStart()" class="text-brand-sage text-xs tracking-widest hover:text-brand-ink transition-colors mb-4 flex items-center justify-center mx-auto">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                    返回選單
                </button>
                <h3 class="text-xl font-serif text-brand-ink mb-2">愛之語圖鑑</h3>
                <p class="text-xs text-brand-ink/50 tracking-wider">點擊卡片以探索細節</p>
            </div>
            
            <div id="intro-container" class="grid grid-cols-2 md:grid-cols-3 gap-4 md:gap-6">
                <!-- Cards will be injected by JS -->
            </div>
            
            <div class="mt-12 text-center">
                <!-- 更改為 18題 -->
                <button onclick="startQuiz()" class="px-10 py-3 bg-brand-sage text-white rounded-full hover:bg-brand-ink transition-all duration-300 tracking-widest text-sm shadow-card hover:shadow-lg transform hover:-translate-y-1">
                    我準備好開始測驗了
                </button>
            </div>
        </div>

        <!-- Intro Detail Modal (Hidden by default) -->
        <div id="intro-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
            <div class="absolute inset-0 modal-backdrop" onclick="closeIntroModal()"></div>
            <div class="relative bg-white w-full max-w-lg rounded-xl shadow-2xl p-8 md:p-10 border border-brand-sage/20 transform transition-all scale-100 max-h-[90vh] overflow-y-auto no-scrollbar">
                <button onclick="closeIntroModal()" class="absolute top-4 right-4 text-brand-sage hover:text-brand-ink transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
                
                <div id="modal-icon-container" class="w-16 h-16 mx-auto bg-brand-paper rounded-full flex items-center justify-center text-brand-sage mb-6">
                    <!-- Icon injected here -->
                </div>
                
                <h3 id="modal-title" class="text-2xl font-serif text-brand-ink text-center mb-1"></h3>
                <p id="modal-entitle" class="text-xs text-brand-sage text-center mb-6 tracking-widest uppercase"></p>
                
                <div class="space-y-6">
                    <div>
                        <h4 class="text-xs font-bold text-brand-clay tracking-widest mb-2 uppercase">Core Definition</h4>
                        <p id="modal-desc" class="text-brand-ink/80 text-sm leading-relaxed text-justify font-serif"></p>
                    </div>
                    
                    <div class="bg-brand-paper p-4 rounded border border-brand-sand/50">
                        <h4 class="text-xs font-bold text-brand-sage tracking-widest mb-2 uppercase">Energy Keywords</h4>
                        <div id="modal-keywords" class="flex flex-wrap gap-2">
                            <!-- Keywords injected -->
                        </div>
                    </div>
                </div>
                
                <button onclick="closeIntroModal()" class="mt-8 w-full py-3 border border-brand-sand text-brand-ink/60 hover:text-brand-ink hover:border-brand-sage rounded transition-colors text-sm tracking-wide">
                    了解，看下一個
                </button>
            </div>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="hidden fade-in">
            <div class="mb-8 flex justify-between items-center text-xs text-brand-sage tracking-widest">
                <span id="question-counter">Question 1 / 18</span>
                <div class="w-32 h-1 bg-brand-sand rounded-full overflow-hidden">
                    <div id="progress-bar" class="h-full bg-brand-sage transition-all duration-500" style="width: 0%"></div>
                </div>
            </div>

            <h3 id="question-text" class="text-xl md:text-2xl font-serif text-brand-ink mb-8 leading-relaxed text-center min-h-[4em] flex items-center justify-center">
                題目載入中...
            </h3>

            <div id="options-container" class="space-y-4">
                <!-- Options will be injected here -->
            </div>
        </div>

        <!-- Result Screen -->
        <div id="result-screen" class="hidden fade-in">
            <div class="bg-white/60 border border-brand-sand p-8 md:p-12 rounded-lg shadow-soft text-center">
                <p class="text-brand-sage text-xs tracking-[0.2em] mb-4 uppercase">Your Love Language</p>
                <h2 class="text-3xl md:text-4xl font-serif text-brand-ink mb-6" id="result-title">分析中...</h2>
                <div class="w-16 h-1 bg-brand-clay mx-auto mb-8"></div>
                
                <p id="result-desc" class="text-brand-ink/80 leading-loose text-justify mb-8 font-serif">
                    <!-- Description -->
                </p>

                <!-- Actionable Examples for the WINNER -->
                <div class="bg-brand-sage/10 border border-brand-sage/30 rounded p-6 mb-12 text-left">
                    <h4 class="text-brand-sage font-bold text-sm mb-4 flex items-center justify-between">
                        <span class="flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            感受到被愛的方式 (具體範例)
                        </span>
                        <span class="text-xs bg-brand-sage text-white px-2 py-1 rounded-full opacity-80" id="examples-count-badge">20 Ideas</span>
                    </h4>
                    
                    <!-- 修正：移除 overflow-hidden 與固定高度，讓內容自然伸展，避免手機版文字被切斷 -->
                    <ul id="winner-examples" class="list-disc list-inside text-sm text-brand-ink/80 leading-relaxed space-y-3 font-serif transition-opacity duration-300">
                        <!-- Winner examples injected here -->
                    </ul>
                    
                    <div class="text-center mt-6 pt-4 border-t border-brand-sage/20">
                        <button id="toggle-examples-btn" onclick="toggleExamples()" class="text-xs font-bold text-brand-sage hover:text-brand-ink tracking-widest uppercase flex items-center justify-center mx-auto transition-colors">
                            展開查看所有 20 個範例
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 ml-1 transform transition-transform duration-300" id="toggle-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Bar Chart Section -->
                <div class="mb-12 text-left">
                    <h4 class="text-center text-brand-sage text-xs tracking-[0.2em] mb-6 uppercase">你的愛之語組成 (Profile)</h4>
                    <div id="chart-container" class="space-y-4 max-w-lg mx-auto bg-brand-paper/50 p-6 rounded-lg border border-brand-sand/50">
                        <!-- Chart bars will be injected here -->
                    </div>
                </div>

                <!-- Self & Partner Tips -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-left mb-12">
                    <div class="p-6 bg-brand-paper border border-brand-sand rounded h-full">
                        <h4 class="text-brand-sage text-sm font-bold mb-2">如何愛自己</h4>
                        <p id="self-love-tip" class="text-sm text-brand-ink/70 leading-relaxed"></p>
                    </div>
                    <div class="p-6 bg-brand-paper border border-brand-sand rounded h-full">
                        <h4 class="text-brand-sage text-sm font-bold mb-2">給伴侶的建議</h4>
                        <p id="partner-tip" class="text-sm text-brand-ink/70 leading-relaxed"></p>
                    </div>
                </div>

                <!-- All Languages Reference Guide -->
                <div class="mb-12 border-t border-brand-sand pt-10 text-left">
                    <h4 class="text-center text-brand-ink font-serif text-lg mb-2">常溫情感指南</h4>
                    <p class="text-center text-xs text-brand-ink/50 mb-8 tracking-wide">與伴侶分享這份指南，找出彼此最舒服的相處頻率</p>
                    
                    <div id="all-languages-guide" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- All languages examples injected here -->
                    </div>
                </div>

                <div class="flex flex-col md:flex-row justify-center gap-4">
                    <button onclick="restartQuiz()" class="px-6 py-2 border border-brand-sage text-brand-sage rounded hover:bg-brand-sage hover:text-white transition-all duration-300 text-sm tracking-wide">
                        重新測驗
                    </button>
                    <!-- LINE@ -->
                    <a href="https://line.me/R/ti/p/@890mvlvl" target="_blank" class="px-6 py-2 bg-brand-ink text-white rounded hover:bg-brand-clay transition-all duration-300 text-sm tracking-wide shadow-md">
                        加入 LINE@ 預約諮詢
                    </a>
                </div>
            </div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="w-full text-center py-8 text-xs text-brand-ink/40 tracking-widest border-t border-brand-sand/30 mt-auto">
        <p>2026 常溫編集所 Ambient Edit Studio.</p>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        const languages = {
            affirmation: {
                title: "肯定的言語",
                enTitle: "Words of Affirmation",
                icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" /></svg>`,
                desc: "語言對你來說擁有強大的力量。一句真誠的讚美、鼓勵或「我愛你」，能讓你的靈魂飛揚。相反地，尖酸刻薄的話語對你的傷害也特別深。你渴望被看見、被認可，聽覺是你接收愛的主要頻率。",
                keywords: ["讚美", "鼓勵", "書信", "肯定", "表達"],
                self: "每天早上對鏡子說三句肯定自己的話。寫下自己的優點日記。",
                partner: "請多給予他/她具體的讚美。不要吝嗇說出你的欣賞，寫小紙條或傳簡訊表達愛意會很有效果。",
                examples: [
                    "主動稱讚我的外表、穿搭或新髮型",
                    "在朋友或家人面前公開讚美我的成就",
                    "寫一張便利貼說「我愛你」並貼在冰箱或鏡子上",
                    "當我遇到挫折時，堅定地告訴我「你已經做得很好了」",
                    "傳一則訊息告訴我，你有多欣賞我某個具體的特質",
                    "睡前告訴我一件今天你覺得我做得很棒的事",
                    "對我說「謝謝你為這個家付出的努力」",
                    "寫一封手寫信，細數我們相處的美好回憶",
                    "當我穿新衣服時，給予熱情的反應",
                    "在我懷疑自己時，列舉三個我的優點給我聽",
                    "即使是小事，也常把「謝謝」掛在嘴邊",
                    "告訴我「有你在真好」",
                    "稱讚我的專業能力或解決問題的方法",
                    "在社群媒體上分享我們的合照並寫下甜蜜的話",
                    "專心地聽我說話，並給予正向的回饋",
                    "用溫柔的語氣叫我的暱稱",
                    "肯定我的夢想，並說「我相信你一定做得到」",
                    "當我做家事時，說一句「辛苦了，這很有幫助」",
                    "記得我說過的話，並在對話中引用，表示你有在聽",
                    "每天出門前說一句「祝你今天順利，愛你」"
                ]
            },
            service: {
                title: "服務的行動",
                enTitle: "Acts of Service",
                icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 11.5V14m0-2.5v-6a1.5 1.5 0 113 0m-3 6a1.5 1.5 0 00-3 0v2a7.5 7.5 0 0015 0v-5a1.5 1.5 0 00-3 0m-6-3V11m0-5.5v-1a1.5 1.5 0 013 0v1m0 0V11m0-5.5a1.5 1.5 0 013 0v3m0 0V11" /></svg>`,
                desc: "對你而言，行動勝於空談。「讓我來幫你」是你覺得最悅耳的情話。當有人主動為你分擔責任、處理瑣事，你會感受到深深的被愛與被照顧。你重視的是那份「為了讓我輕鬆一點」的貼心。",
                keywords: ["分擔", "主動", "體貼", "照顧", "執行力"],
                self: "為自己做一頓健康的飯菜，或是整理好居住環境，讓自己處於舒適的狀態。",
                partner: "主動詢問「有什麼我可以幫忙的嗎？」。用實際行動分擔家務或解決他的煩惱，比送禮物更讓他感動。",
                examples: [
                    "在我還沒開口前，主動把碗洗好或把垃圾倒了",
                    "在我生病或疲累時，為我準備一杯熱水、維他命或感冒藥",
                    "幫我處理我不擅長的電腦問題、報稅或行政雜務",
                    "順手幫我的手機充電，或把我的車加滿油",
                    "早上比我早起一點，幫我煮好咖啡或準備早餐",
                    "看到我忙不過來時，主動接手照顧寵物或小孩",
                    "幫我跑腿去拿乾洗的衣服或取包裹",
                    "在我加班時，默默準備好宵夜或水果",
                    "整理我們凌亂的儲藏室或衣櫃",
                    "幫我按摩僵硬的肩膀（帶有服務與照顧性質）",
                    "主動規劃週末的行程，不用我操心",
                    "幫我修理壞掉的家電或更換燈泡",
                    "提醒我重要的待辦事項，避免我忘記",
                    "在下雨天時，主動去開車過來接我",
                    "幫我剝蝦、挑魚刺或切水果",
                    "替我分擔我討厭做的某項家務（例如刷馬桶）",
                    "為我準備好隔天要穿的衣服或便當",
                    "在我忙碌時，幫我過濾掉不必要的電話或打擾",
                    "主動清洗並保養我的車子",
                    "說「這件事交給我處理，你去休息」"
                ]
            },
            gifts: {
                title: "真心的禮物",
                enTitle: "Receiving Gifts",
                icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" /></svg>`,
                desc: "你重視的不是禮物的價格，而是背後的「心思」。禮物代表著「有人在想念我」。這是一種視覺化的愛，透過具體的物品，你確認了自己在對方心中的位置。你也喜歡在特別的日子透過送禮來表達愛。",
                keywords: ["驚喜", "心思", "紀念", "象徵", "想念"],
                self: "偶爾買一束花給自己，或是收藏一個令你心動的小物件。",
                partner: "記住特殊的紀念日。送禮時，附上一張手寫卡片說明為什麼選這個禮物，會讓價值倍增。",
                examples: [
                    "出差或旅行時，特地帶回給我的當地小紀念品",
                    "記得我隨口說過想吃的零食，並在下班時順路買回來",
                    "在非節日的時候，送我一個實用的小驚喜",
                    "親手製作的卡片、相冊或手工藝品",
                    "送我一束花，不需要特別理由，只因為想送",
                    "訂閱我喜歡的雜誌或串流服務送給我",
                    "把我們的合照洗出來裝在漂亮的相框裡送我",
                    "買一本覺得我會喜歡的書，並在扉頁寫下留言",
                    "記得我的衣服尺寸，買一件適合我的衣服",
                    "送我一個能讓生活更便利的小家電",
                    "精心包裝禮物，讓我享受拆禮物的儀式感",
                    "買我觀望很久但捨不得買的東西給我",
                    "為我準備一份「體驗式禮物」，例如按摩券或展覽票",
                    "在我的枕頭下藏一顆巧克力或小糖果",
                    "送我一盆好照顧的植栽，放在我的辦公桌上",
                    "記得我們紀念日的特殊意義，送上象徵性的禮物",
                    "收集我喜歡的餐廳優惠券或菜單，帶我去吃",
                    "買一個質感好的馬克杯，專屬給我用",
                    "為我建立一個專屬的歌單",
                    "在禮物中附上一張手寫的小紙條，說明為什麼選這個"
                ]
            },
            time: {
                title: "精心的時刻",
                enTitle: "Quality Time",
                icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>`,
                desc: "你最渴望的是全神貫注的陪伴。放下手機、關掉電視，彼此眼神交流、深度對話，或是僅僅是一起散步。對你來說，愛就是「把時間留給你」，這代表你比其他事物都重要。",
                keywords: ["專注", "陪伴", "傾聽", "共同回憶", "當下"],
                self: "每週保留一段完全屬於自己的空白時間，去咖啡廳閱讀或獨自散步。",
                partner: "安排沒有干擾的約會。當他在說話時，請看著他的眼睛，給予完整的回應，不要分心。",
                examples: [
                    "用餐時把手機收起來，關掉電視，專心地聽我說話",
                    "安排一個週末下午，兩個人一起去散步、爬山或看展覽",
                    "睡前留10-15分鐘，躺在床上聊聊今天發生的事情與感受",
                    "一起培養一個共同的興趣，例如做菜、園藝或運動",
                    "安排一場「無科技約會」，只有我們兩個人",
                    "一起拼完一幅拼圖或組裝模型",
                    "坐在咖啡廳裡，各自看書但偶爾相視而笑的陪伴",
                    "規劃一次兩天一夜的小旅行，專注於彼此",
                    "一起去上課學習新技能（如陶藝、語言）",
                    "開車兜風，漫無目的地聊天",
                    "陪我去做我喜歡但你沒興趣的事（例如逛街或看球賽）",
                    "一起回顧舊照片，聊聊當時的回憶",
                    "在週末早晨一起做早餐並慢慢享用",
                    "每天固定時間一起喝茶或咖啡",
                    "專注地看著我的眼睛說話，不分心做其他事",
                    "一起計畫未來的夢想藍圖",
                    "陪我散步去買東西，即使只是去便利商店",
                    "一起玩桌遊或電玩遊戲",
                    "預留「約會之夜」，不讓工作或朋友打擾",
                    "只是靜靜地坐在一起看夕陽或聽音樂"
                ]
            },
            touch: {
                title: "身體的接觸",
                enTitle: "Physical Touch",
                icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" /></svg>`,
                desc: "透過觸碰，你感受到安全感與歸屬感。牽手、擁抱、親吻，或是坐在一起時肩膀的輕靠，都是你接收愛的訊號。身體的距離直接影響你心理的距離，觸摸是你確認關係穩固的錨點。",
                keywords: ["擁抱", "溫度", "安全感", "親密", "依靠"],
                self: "去按摩放鬆，或是洗個熱水澡，使用質感好的乳液呵護肌膚。",
                partner: "出門前和回家後的一個擁抱。走路時牽著手，坐著時自然的肢體接觸，能讓他感到安心。",
                examples: [
                    "過馬路或人多時，自然地牽起我的手或摟著腰",
                    "看電視時讓我依靠在你的肩膀上，或玩我的頭髮",
                    "出門前和回家後，給我一個深情的擁抱與吻",
                    "當我感到焦慮時，輕輕拍拍我的背安撫我",
                    "睡覺時相擁入眠，或至少手腳有碰觸",
                    "坐在一起時，膝蓋或大腿自然地靠在一起",
                    "幫我按摩肩膀、背部或腿部放鬆",
                    "走路時勾著我的手",
                    "不經意地摸摸我的頭或臉頰",
                    "在公共場合偷偷捏一下我的手心",
                    "坐在沙發上時，把腿跨在你的腿上",
                    "騎車時緊緊抱著你的腰",
                    "幫我擦乳液或吹頭髮",
                    "玩鬧時的搔癢或輕推",
                    "經過我身邊時，順手摸一下我的背",
                    "早上醒來時的早安吻",
                    "靠得很近說悄悄話",
                    "把頭埋在我的頸窩撒嬌",
                    "握著我的手開車（注意安全的前提下）",
                    "只是單純地享受「肌膚之親」的親密感"
                ]
            },
            spiritual: {
                title: "心靈的連結",
                enTitle: "Spiritual Connection",
                icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" /></svg>`,
                desc: "這是較為深層的愛之語。你渴望的是靈魂的共鳴、價值觀的契合以及共同成長的願景。當有人能理解你未說出口的感受，或是願意與你探討生命的意義時，你會感受到極致的愛與被理解。",
                keywords: ["共鳴", "成長", "理解", "深度", "價值觀"],
                self: "冥想、瑜伽或閱讀哲學書籍。花時間與自己的內在對話。",
                partner: "分享彼此的夢想與恐懼。展現脆弱的一面，並進行深度的知性或靈性對談。",
                examples: [
                    "與我討論對未來的願景，確認我們方向一致",
                    "分享最近閱讀的一本書、電影或Podcast帶來的啟發",
                    "當我表達抽象感受或情緒時，嘗試理解而不急著批判或解決",
                    "一起進行冥想、瑜伽或正念呼吸的練習",
                    "陪我去參加心靈成長課程、講座或宗教活動",
                    "深入討論彼此的價值觀、信仰或人生哲學",
                    "展現你脆弱的一面，告訴我你深層的恐懼與渴望",
                    "支持我去追尋看似不切實際的夢想",
                    "一起做公益或志工，體驗付出的快樂",
                    "在安靜的時刻，進行一場沒有禁忌的深度對談",
                    "互相分享童年的創傷，並給予療癒的擁抱",
                    "一起欣賞大自然的壯麗，感受宇宙的浩瀚",
                    "詢問我「你覺得生命的意義是什麼？」並認真聆聽",
                    "尊重並支持我獨處充電的時間",
                    "一起創造屬於我們的家庭儀式或傳統",
                    "用開放的心態討論社會議題或世界局勢",
                    "鼓勵我誠實面對自己的內心，做真實的自己",
                    "在我迷惘時，陪我釐清混亂的思緒，尋找內在指引",
                    "感謝彼此在靈魂層次上的陪伴與成長",
                    "建立我們共同的「夢想清單」並一起實踐"
                ]
            }
        };

        // 【專業心理測驗優化：18題完美分佈設計】
        // 在 6 個維度中，18題 * 3選項 = 54選項，每個維度精準出現 9 次，達到機率的完全客觀平衡。
        const questions = [
            {
                q: "當我感到疲憊與挫折時，我最希望伴侶...",
                options: [
                    { text: "過來抱抱我，讓我依靠一下", type: "touch" },
                    { text: "幫我處理掉那些讓我煩心的雜事", type: "service" },
                    { text: "專心地聽我訴苦，陪我度過這段時間", type: "time" }
                ]
            },
            {
                q: "什麼樣的驚喜最能打動我的心？",
                options: [
                    { text: "一份我曾無意間提到想要的禮物", type: "gifts" },
                    { text: "一封寫滿對我的欣賞與愛意的長信", type: "affirmation" },
                    { text: "一場安排好的深度旅行，只有我們兩個人", type: "time" }
                ]
            },
            {
                q: "我覺得最浪漫的時刻是...",
                options: [
                    { text: "我們能夠不用言語，就能懂得彼此的心意", type: "spiritual" },
                    { text: "他/她主動把家裡打掃乾淨，讓我回家能放鬆", type: "service" },
                    { text: "我們緊緊依偎在一起看電影", type: "touch" }
                ]
            },
            {
                q: "如果伴侶要表達對我的支持，我希望他/她...",
                options: [
                    { text: "告訴我：「我相信你一定做得到，你很棒」", type: "affirmation" },
                    { text: "買一份具象徵意義的幸運物送給我", type: "gifts" },
                    { text: "與我討論未來的規劃，確認我們的目標一致", type: "spiritual" }
                ]
            },
            {
                q: "在一段關係中，我最不能忍受的是...",
                options: [
                    { text: "長時間沒有身體的親密接觸", type: "touch" },
                    { text: "即使在一起，對方卻總是在滑手機", type: "time" },
                    { text: "對我的付出視為理所當然，沒有一句感謝", type: "affirmation" }
                ]
            },
            {
                q: "關於生日禮物，我更傾向...",
                options: [
                    { text: "一個精挑細選、包裝精美的實體禮物", type: "gifts" },
                    { text: "對方親手做的一頓大餐或是幫我完成一個願望", type: "service" },
                    { text: "一段深刻的對話，分享這一年彼此的成長", type: "spiritual" }
                ]
            },
             {
                q: "讓我感覺「被愛著」的日常瞬間是...",
                options: [
                    { text: "出門前的一個吻或擁抱", type: "touch" },
                    { text: "收到一條寫著「想你」或稱讚我的訊息", type: "affirmation" },
                    { text: "發現他/她默默把壞掉的東西修好了", type: "service" }
                ]
            },
             {
                q: "我認為最理想的約會方式是...",
                options: [
                    { text: "去參加心靈成長課程或展覽，交流想法", type: "spiritual" },
                    { text: "沒有特別行程，但全心全意陪伴彼此的午後", type: "time" },
                    { text: "互相交換精心準備的小禮物", type: "gifts" }
                ]
            },
            {
                q: "當我們發生衝突後，最能讓我感到關係修復的是...",
                options: [
                    { text: "聽到對方誠懇地說「對不起，我很在乎你」", type: "affirmation" },
                    { text: "一個長長的擁抱，即使不說話也感到安心", type: "touch" },
                    { text: "對方主動去處理了那個引發爭執的問題", type: "service" }
                ]
            },
            {
                q: "對於「家」的氛圍，我最重視...",
                options: [
                    { text: "充滿了我們精心挑選、有共同回憶的物品", type: "gifts" },
                    { text: "一個能讓我們自在地進行深度對談的角落", type: "spiritual" },
                    { text: "兩個人一起窩在沙發上，享受無所事事的時光", type: "time" }
                ]
            },
            {
                q: "我覺得伴侶最迷人的時刻是...",
                options: [
                    { text: "在我忙碌混亂時，默默幫我把便當準備好", type: "service" },
                    { text: "他/她深情地看著我，堅定地說出對我的愛", type: "affirmation" },
                    { text: "我們在某個價值觀上產生深刻共鳴的時候", type: "spiritual" }
                ]
            },
            {
                q: "如果我要獎勵自己一段美好的時光，我傾向...",
                options: [
                    { text: "去按摩或SPA享受身體的放鬆", type: "touch" },
                    { text: "買一個觀望很久的高質感商品送給自己", type: "gifts" },
                    { text: "安排一場沒有目的的漫遊，享受獨處時光", type: "time" }
                ]
            },
            {
                q: "當我因為工作或生活感到焦慮不安時，我希望...",
                options: [
                    { text: "對方能和我一起分析問題，給我精神上的指引", type: "spiritual" },
                    { text: "對方能多給我一些肯定，告訴我已經做得夠好了", type: "affirmation" },
                    { text: "什麼都不用說，只要安靜地陪在我身邊就好", type: "time" }
                ]
            },
            {
                q: "若要選擇一種方式來紀念我們的週年，我會選...",
                options: [
                    { text: "回到我們初識的地方，重溫當時的回憶", type: "time" },
                    { text: "互贈一份象徵我們感情的紀念品", type: "gifts" },
                    { text: "一起去完成一件我們一直想做但沒做的事", type: "service" }
                ]
            },
            {
                q: "在親密關係中，我覺得最深層的孤獨是...",
                options: [
                    { text: "即使睡在同一張床上，卻沒有肢體的觸碰", type: "touch" },
                    { text: "我們的對話只剩下柴米油鹽，沒有心靈交流", type: "spiritual" },
                    { text: "我付出了很多努力，對方卻視而不見", type: "affirmation" }
                ]
            },
            {
                q: "如果我生病了，我最希望伴侶...",
                options: [
                    { text: "親自為我煮粥、餵我吃藥，照顧我的起居", type: "service" },
                    { text: "買我喜歡的書或小東西來讓我開心一點", type: "gifts" },
                    { text: "時常撫摸我的頭或握著我的手，給我力量", type: "touch" }
                ]
            },
            {
                q: "週未早晨，我理想的狀態是...",
                options: [
                    { text: "兩個人一起分工合作，準備豐盛的早餐", type: "service" },
                    { text: "賴在床上享受肌膚之親的溫存時光", type: "touch" },
                    { text: "一起喝咖啡，聊聊最近的想法與感受", type: "time" }
                ]
            },
            {
                q: "當我獲得成就時，我最期待伴侶...",
                options: [
                    { text: "送我一份禮物來慶祝這個里程碑", type: "gifts" },
                    { text: "在社群媒體或朋友面前大方地誇獎我", type: "affirmation" },
                    { text: "與我深入討論這份成就對我的人生意義", type: "spiritual" }
                ]
            }
        ];

        let currentQuestionIndex = 0;
        let scores = {
            affirmation: 0,
            service: 0,
            gifts: 0,
            time: 0,
            touch: 0,
            spiritual: 0
        };

        const LOCAL_STORAGE_KEY = 'ambient_love_language_result_v2'; 

        function init() {
            const savedResult = localStorage.getItem(LOCAL_STORAGE_KEY);
            if (savedResult) {
                document.getElementById('history-alert').classList.remove('hidden');
            }
            renderIntro();
        }

        // Render Intro Cards
        function renderIntro() {
            const container = document.getElementById('intro-container');
            container.innerHTML = '';
            
            Object.entries(languages).forEach(([key, lang]) => {
                const card = document.createElement('div');
                card.className = "bg-brand-paper border border-brand-sand rounded-xl p-6 shadow-sm hover:shadow-card hover:bg-white cursor-pointer transition-all duration-300 transform hover:-translate-y-1 flex flex-col items-center justify-center text-center group h-48 md:h-56 relative overflow-hidden";
                card.onclick = () => openIntroModal(key);
                
                // Add a subtle decorative circle
                card.innerHTML = `
                    <div class="absolute top-0 right-0 -mr-8 -mt-8 w-24 h-24 bg-brand-sage/5 rounded-full transition-transform group-hover:scale-150 duration-500"></div>
                    
                    <div class="text-brand-sage group-hover:text-brand-clay transition-colors duration-300 mb-4 transform group-hover:scale-110">
                        ${lang.icon}
                    </div>
                    <h4 class="text-brand-ink font-bold text-lg mb-1 font-serif group-hover:text-brand-sage transition-colors">${lang.title}</h4>
                    <span class="text-xs text-brand-ink/40 tracking-wider uppercase font-sans">${lang.enTitle}</span>
                    
                    <div class="mt-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 absolute bottom-4 text-xs text-brand-sage font-bold tracking-widest flex items-center">
                        EXPLORE
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                        </svg>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Modal Functions
        function openIntroModal(key) {
            const data = languages[key];
            const modal = document.getElementById('intro-modal');
            
            // Populate Data
            document.getElementById('modal-icon-container').innerHTML = data.icon;
            document.getElementById('modal-title').innerText = data.title;
            document.getElementById('modal-entitle').innerText = data.enTitle;
            document.getElementById('modal-desc').innerText = data.desc;
            
            const kwContainer = document.getElementById('modal-keywords');
            kwContainer.innerHTML = '';
            data.keywords.forEach(kw => {
                const span = document.createElement('span');
                span.className = "px-2 py-1 bg-brand-sage/10 text-brand-sage text-xs rounded-md";
                span.innerText = `#${kw}`;
                kwContainer.appendChild(span);
            });

            modal.classList.remove('hidden');
        }

        function closeIntroModal() {
            document.getElementById('intro-modal').classList.add('hidden');
        }

        function showIntro() {
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('intro-screen').classList.remove('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function backToStart() {
            document.getElementById('intro-screen').classList.add('hidden');
            document.getElementById('start-screen').classList.remove('hidden');
        }

        function startQuiz() {
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('intro-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            showQuestion();
        }

        function showQuestion() {
            const q = questions[currentQuestionIndex];
            document.getElementById('question-text').innerText = q.q;
            document.getElementById('question-counter').innerText = `Question ${currentQuestionIndex + 1} / ${questions.length}`;
            
            // Update Progress Bar
            const progress = ((currentQuestionIndex) / questions.length) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;

            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';

            // Shuffle options
            const shuffledOptions = [...q.options].sort(() => Math.random() - 0.5);

            shuffledOptions.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = "option-btn w-full text-left p-6 bg-white border border-brand-sand rounded hover:border-brand-sage hover:bg-brand-paper hover:shadow-soft transition-all duration-300 text-brand-ink/80 font-sans leading-relaxed";
                btn.innerText = opt.text;
                btn.onclick = () => selectOption(opt.type);
                optionsContainer.appendChild(btn);
            });
        }

        function selectOption(type) {
            scores[type]++;
            currentQuestionIndex++;

            if (currentQuestionIndex < questions.length) {
                showQuestion();
            } else {
                calculateResult();
            }
        }

        function calculateResult() {
            let maxScore = -1;
            let resultKey = '';
            
            const sortedScores = Object.entries(scores).sort(([,a], [,b]) => b - a);
            resultKey = sortedScores[0][0];

            const resultData = {
                key: resultKey,
                allScores: scores,
                timestamp: new Date().getTime()
            };
            localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(resultData));
            
            renderResult(resultKey, scores);
        }

        // Logic to handle 20 examples without fixed height cutting off on mobile
        let isExamplesExpanded = false;
        let currentWinnerKey = '';

        function renderResult(key, allScores) {
            currentWinnerKey = key;
            const data = languages[key];
            
            document.getElementById('quiz-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            
            document.getElementById('result-title').innerText = `${data.title} (${data.enTitle})`;
            document.getElementById('result-desc').innerText = data.desc;
            document.getElementById('self-love-tip').innerText = data.self;
            document.getElementById('partner-tip').innerText = data.partner;

            // Reset Expansion State
            isExamplesExpanded = false;
            renderExamples(data.examples);

            renderChart(allScores);
            renderAllGuide();

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function renderExamples(examples) {
            const list = document.getElementById('winner-examples');
            const btn = document.getElementById('toggle-examples-btn');
            
            // Default show 5
            const countToShow = isExamplesExpanded ? examples.length : 5;
            
            // Fade out effect
            list.classList.add('opacity-0');
            
            setTimeout(() => {
                list.innerHTML = '';
                examples.slice(0, countToShow).forEach(ex => {
                    const li = document.createElement('li');
                    li.className = "pl-2"; 
                    li.innerText = ex;
                    list.appendChild(li);
                });
                
                // Fade in effect
                list.classList.remove('opacity-0');
            }, 150);

            // Update button text
            if (isExamplesExpanded) {
                btn.innerHTML = `收起範例 <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 ml-1 transform rotate-180 transition-transform duration-300" id="toggle-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>`;
            } else {
                btn.innerHTML = `展開查看所有 20 個範例 <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 ml-1 transform transition-transform duration-300" id="toggle-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>`;
            }
        }

        function toggleExamples() {
            isExamplesExpanded = !isExamplesExpanded;
            if (currentWinnerKey) {
                renderExamples(languages[currentWinnerKey].examples);
            }
        }

        function renderChart(allScores) {
            const container = document.getElementById('chart-container');
            container.innerHTML = '';

            // 【優化：改為相對滿分制顯示】找出使用者的最高分，作為長條圖的 100% 寬度基準
            const maxScore = Math.max(...Object.values(allScores));

            const sorted = Object.entries(allScores)
                .map(([key, value]) => ({ 
                    key, 
                    value, 
                    label: languages[key].title,
                    // 以最高分為基準計算百分比，這樣第一名一定會填滿整個 Bar
                    percent: maxScore > 0 ? Math.round((value / maxScore) * 100) : 0
                }))
                .sort((a, b) => b.value - a.value);

            sorted.forEach(item => {
                const barWrapper = document.createElement('div');
                barWrapper.className = "w-full";
                
                barWrapper.innerHTML = `
                    <div class="flex justify-between text-xs text-brand-ink/70 mb-1 font-sans">
                        <span>${item.label}</span>
                        <!-- 不顯示%，改顯示實際得分 -->
                        <span class="font-bold text-brand-sage">${item.value} 分</span>
                    </div>
                    <div class="w-full bg-brand-sand/30 rounded-full h-2.5 overflow-hidden">
                        <div class="chart-bar h-full bg-brand-sage rounded-full" style="width: 0%" data-width="${item.percent}%"></div>
                    </div>
                `;
                container.appendChild(barWrapper);
            });

            setTimeout(() => {
                document.querySelectorAll('.chart-bar').forEach(bar => {
                    bar.style.width = bar.getAttribute('data-width');
                });
            }, 100);
        }

        function renderAllGuide() {
            const container = document.getElementById('all-languages-guide');
            container.innerHTML = '';

            Object.entries(languages).forEach(([key, val]) => {
                const card = document.createElement('div');
                card.className = "bg-brand-paper/50 border border-brand-sand rounded p-4 text-left hover:bg-white hover:shadow-soft transition-all duration-300 cursor-pointer group";
                card.onclick = () => openIntroModal(key); 
                
                const briefExamples = val.examples.slice(0, 2).map(e => `<li>${e}</li>`).join('');

                card.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <h5 class="text-brand-sage font-bold text-sm tracking-wide group-hover:text-brand-ink transition-colors">${val.title}</h5>
                        <div class="text-brand-sand group-hover:text-brand-sage transition-colors transform scale-75 origin-right">
                           ${val.icon}
                        </div>
                    </div>
                    <ul class="list-disc list-inside text-xs text-brand-ink/70 leading-relaxed space-y-1 mb-3">
                        ${briefExamples}
                    </ul>
                    <div class="text-right">
                        <span class="text-[10px] text-brand-sage/60 uppercase tracking-widest group-hover:underline">View Details</span>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function showResult() {
            const savedDataString = localStorage.getItem(LOCAL_STORAGE_KEY);
            if (savedDataString) {
                try {
                    const savedData = JSON.parse(savedDataString);
                    if (typeof savedData === 'string') {
                         restartQuiz();
                    } else {
                        document.getElementById('start-screen').classList.add('hidden');
                        renderResult(savedData.key, savedData.allScores);
                    }
                } catch (e) {
                    restartQuiz();
                }
            }
        }

        function restartQuiz() {
            localStorage.removeItem(LOCAL_STORAGE_KEY);
            currentQuestionIndex = 0;
            scores = { affirmation: 0, service: 0, gifts: 0, time: 0, touch: 0, spiritual: 0 };
            document.getElementById('result-screen').classList.add('hidden');
            document.getElementById('start-screen').classList.remove('hidden');
            document.getElementById('history-alert').classList.add('hidden');
        }

        init();

    </script>
</body>
</html>
